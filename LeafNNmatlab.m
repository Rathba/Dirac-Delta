img=imread('DSC_0365.jpg');
img=imresize(img,[20 20]);
x(1,:)=img(:);
img=imread('DSC_0366.jpg');
img=imresize(img,[20 20]);
x(2,:)=img(:);
img=imread('DSC_0367.jpg');
img=imresize(img,[20 20]);
x(3,:)=img(:);
img=imread('DSC_0370.jpg');
img=imresize(img,[20 20]);
x(4,:)=img(:);
img=imread('DSC_0372.jpg');
img=imresize(img,[20 20]);
x(5,:)=img(:);
img=imread('DSC_0373.jpg');
img=imresize(img,[20 20]);
x(6,:)=img(:);
img=imread('DSC_0374.jpg');
img=imresize(img,[20 20]);
x(7,:)=img(:);
img=imread('DSC_0375.jpg');
img=imresize(img,[20 20]);
x(8,:)=img(:);
img=imread('DSC_0376.jpg');
img=imresize(img,[20 20]);
x(9,:)=img(:);
img=imread('DSC_0377.jpg');
img=imresize(img,[20 20]);
x(10,:)=img(:);
img=imread('DSC_0378.jpg');
img=imresize(img,[20 20]);
x(11,:)=img(:);
img=imread('DSC_0379.jpg');
img=imresize(img,[20 20]);
x(12,:)=img(:);
img=imread('DSC_0380.jpg');
img=imresize(img,[20 20]);
x(13,:)=img(:);
img=imread('DSC_0381.jpg');
img=imresize(img,[20 20]);
x(14,:)=img(:);
img=imread('DSC_0382.jpg');
img=imresize(img,[20 20]);
x(15,:)=img(:);
img=imread('DSC_0383.jpg');
img=imresize(img,[20 20]);
x(16,:)=img(:);
img=imread('DSC_0384.jpg');
img=imresize(img,[20 20]);
x(17,:)=img(:);
img=imread('DSC_0385.jpg');
img=imresize(img,[20 20]);
x(18,:)=img(:);
img=imread('DSC_0386.jpg');
img=imresize(img,[20 20]);
x(19,:)=img(:);
img=imread('DSC_0388.jpg');
img=imresize(img,[20 20]);
x(20,:)=img(:);
img=imread('DSC_0389.jpg');
img=imresize(img,[20 20]);
x(21,:)=img(:);
img=imread('DSC_0390.jpg');
img=imresize(img,[20 20]);
x(22,:)=img(:);
img=imread('DSC_0392.jpg');
img=imresize(img,[20 20]);
x(23,:)=img(:);
img=imread('DSC_0393.jpg');
img=imresize(img,[20 20]);
x(24,:)=img(:);
img=imread('DSC_0395.jpg');
img=imresize(img,[20 20]);
x(25,:)=img(:);
img=imread('DSC_0396.jpg');
img=imresize(img,[20 20]);
x(26,:)=img(:);
img=imread('DSC_0397.jpg');
img=imresize(img,[20 20]);
x(27,:)=img(:);
img=imread('DSC_0398.jpg');
img=imresize(img,[20 20]);
x(28,:)=img(:);
img=imread('DSC_0399.jpg');
img=imresize(img,[20 20]);
x(29,:)=img(:);
img=imread('DSC_0400.jpg');
img=imresize(img,[20 20]);
x(30,:)=img(:);
img=imread('DSC_0401.jpg');
img=imresize(img,[20 20]);
x(31,:)=img(:);
img=imread('DSC_0402.jpg');
img=imresize(img,[20 20]);
x(32,:)=img(:);
img=imread('DSC_0403.jpg');
img=imresize(img,[20 20]);
x(33,:)=img(:);
img=imread('DSC_0404.jpg');
img=imresize(img,[20 20]);
x(34,:)=img(:);
img=imread('DSC_0405.jpg');
img=imresize(img,[20 20]);
x(35,:)=img(:);
img=imread('DSC_0406.jpg');
img=imresize(img,[20 20]);
x(36,:)=img(:);
img=imread('DSC_0700.jpg');
img=imresize(img,[20 20]);
x(37,:)=img(:);
img=imread('DSC_0701.jpg');
img=imresize(img,[20 20]);
x(38,:)=img(:);
img=imread('DSC_0702.jpg');
img=imresize(img,[20 20]);
x(39,:)=img(:);
img=imread('DSC_0703.jpg');
img=imresize(img,[20 20]);
x(40,:)=img(:);
img=imread('DSC_0100.jpg');
img=imresize(img,[20 20]);
x(41,:)=img(:);
img=imread('DSC_0101.jpg');
img=imresize(img,[20 20]);
x(42,:)=img(:);
img=imread('DSC_0104.jpg');
img=imresize(img,[20 20]);
x(43,:)=img(:);
img=imread('DSC_0105.jpg');
img=imresize(img,[20 20]);
x(44,:)=img(:);
img=imread('DSC_0106.jpg');
img=imresize(img,[20 20]);
x(45,:)=img(:);
img=imread('DSC_0107.jpg');
img=imresize(img,[20 20]);
x(46,:)=img(:);
img=imread('DSC_0108.jpg');
img=imresize(img,[20 20]);
x(47,:)=img(:);
img=imread('DSC_0109.jpg');
img=imresize(img,[20 20]);
x(48,:)=img(:);
img=imread('DSC_0110.jpg');
img=imresize(img,[20 20]);
x(49,:)=img(:);
img=imread('DSC_0111.jpg');
img=imresize(img,[20 20]);
x(50,:)=img(:);
img=imread('DSC_0112.jpg');
img=imresize(img,[20 20]);
x(51,:)=img(:);
img=imread('DSC_0113.jpg');
img=imresize(img,[20 20]);
x(52,:)=img(:);
img=imread('DSC_0114.jpg');
img=imresize(img,[20 20]);
x(53,:)=img(:);
img=imread('DSC_0115.jpg');
img=imresize(img,[20 20]);
x(54,:)=img(:);
img=imread('DSC_0116.jpg');
img=imresize(img,[20 20]);
x(55,:)=img(:);
img=imread('DSC_0117.jpg');
img=imresize(img,[20 20]);
x(56,:)=img(:);
img=imread('DSC_0118.jpg');
img=imresize(img,[20 20]);
x(57,:)=img(:);
img=imread('DSC_0119.jpg');
img=imresize(img,[20 20]);
x(58,:)=img(:);
img=imread('DSC_0121.jpg');
img=imresize(img,[20 20]);
x(59,:)=img(:);
img=imread('DSC_0292.jpg');
img=imresize(img,[20 20]);
x(60,:)=img(:);
img=imread('DSC_0295.jpg');
img=imresize(img,[20 20]);
x(61,:)=img(:);
img=imread('DSC_0296.jpg');
img=imresize(img,[20 20]);
x(62,:)=img(:);
img=imread('DSC_0299.jpg');
img=imresize(img,[20 20]);
x(63,:)=img(:);
img=imread('DSC_0300.jpg');
img=imresize(img,[20 20]);
x(64,:)=img(:);
img=imread('DSC_0301.jpg');
img=imresize(img,[20 20]);
x(65,:)=img(:);
img=imread('DSC_0302.jpg');
img=imresize(img,[20 20]);
x(66,:)=img(:);
img=imread('DSC_0303.jpg');
img=imresize(img,[20 20]);
x(67,:)=img(:);
img=imread('DSC_0304.jpg');
img=imresize(img,[20 20]);
x(68,:)=img(:);
img=imread('DSC_0305.jpg');
img=imresize(img,[20 20]);
x(69,:)=img(:);
img=imread('DSC_0306.jpg');
img=imresize(img,[20 20]);
x(70,:)=img(:);
img=imread('DSC_0307.jpg');
img=imresize(img,[20 20]);
x(71,:)=img(:);
img=imread('DSC_0323.jpg');
img=imresize(img,[20 20]);
x(72,:)=img(:);
img=imread('DSC_0324.jpg');
img=imresize(img,[20 20]);
x(73,:)=img(:);
img=imread('DSC_0325.jpg');
img=imresize(img,[20 20]);
x(74,:)=img(:);
img=imread('DSC_0329.jpg');
img=imresize(img,[20 20]);
x(75,:)=img(:);
img=imread('DSC_0332.jpg');
img=imresize(img,[20 20]);
x(76,:)=img(:);
img=imread('DSC_0333.jpg');
img=imresize(img,[20 20]);
x(77,:)=img(:);
img=imread('DSC_0337.jpg');
img=imresize(img,[20 20]);
x(78,:)=img(:);
img=imread('DSC_0391.jpg');
img=imresize(img,[20 20]);
x(79,:)=img(:);
img=imread('DSC_0394.jpg');
img=imresize(img,[20 20]);
x(80,:)=img(:);
img=imread('DSC_0293.jpg');
img=imresize(img,[20 20]);
x(81,:)=img(:);
img=imread('DSC_0308.jpg');
img=imresize(img,[20 20]);
x(82,:)=img(:);
img=imread('DSC_0309.jpg');
img=imresize(img,[20 20]);
x(83,:)=img(:);
img=imread('DSC_0310.jpg');
img=imresize(img,[20 20]);
x(84,:)=img(:);
img=imread('DSC_0312.jpg');
img=imresize(img,[20 20]);
x(85,:)=img(:);
img=imread('DSC_0313.jpg');
img=imresize(img,[20 20]);
x(86,:)=img(:);
img=imread('DSC_0314.jpg');
img=imresize(img,[20 20]);
x(87,:)=img(:);
img=imread('DSC_0315.jpg');
img=imresize(img,[20 20]);
x(88,:)=img(:);
img=imread('DSC_0316.jpg');
img=imresize(img,[20 20]);
x(89,:)=img(:);
img=imread('DSC_0317.jpg');
img=imresize(img,[20 20]);
x(90,:)=img(:);
img=imread('DSC_0318.jpg');
img=imresize(img,[20 20]);
x(91,:)=img(:);
img=imread('DSC_0319.jpg');
img=imresize(img,[20 20]);
x(92,:)=img(:);
img=imread('DSC_0320.jpg');
img=imresize(img,[20 20]);
x(93,:)=img(:);
img=imread('DSC_0321.jpg');
img=imresize(img,[20 20]);
x(94,:)=img(:);
img=imread('DSC_0322.jpg');
img=imresize(img,[20 20]);
x(95,:)=img(:);
img=imread('DSC_0327.jpg');
img=imresize(img,[20 20]);
x(96,:)=img(:);
img=imread('DSC_0328.jpg');
img=imresize(img,[20 20]);
x(97,:)=img(:);
img=imread('DSC_0330.jpg');
img=imresize(img,[20 20]);
x(98,:)=img(:);
img=imread('DSC_0331.jpg');
img=imresize(img,[20 20]);
x(99,:)=img(:);
img=imread('DSC_0335.jpg');
img=imresize(img,[20 20]);
x(100,:)=img(:);
img=imread('DSC_0336.jpg');
img=imresize(img,[20 20]);
x(101,:)=img(:);
img=imread('DSC_0338.jpg');
img=imresize(img,[20 20]);
x(102,:)=img(:);
img=imread('DSC_0339.jpg');
img=imresize(img,[20 20]);
x(103,:)=img(:);
img=imread('DSC_0500.jpg');
img=imresize(img,[20 20]);
x(104,:)=img(:);
img=imread('DSC_0501.jpg');
img=imresize(img,[20 20]);
x(105,:)=img(:);
img=imread('DSC_0502.jpg');
img=imresize(img,[20 20]);
x(106,:)=img(:);
img=imread('DSC_0503.jpg');
img=imresize(img,[20 20]);
x(107,:)=img(:);
img=imread('DSC_0504.jpg');
img=imresize(img,[20 20]);
x(108,:)=img(:);
img=imread('DSC_0505.jpg');
img=imresize(img,[20 20]);
x(109,:)=img(:);
img=imread('DSC_0506.jpg');
img=imresize(img,[20 20]);
x(110,:)=img(:);
img=imread('DSC_0507.jpg');
img=imresize(img,[20 20]);
x(111,:)=img(:);
img=imread('DSC_0508.jpg');
img=imresize(img,[20 20]);
x(112,:)=img(:);
img=imread('DSC_0509.jpg');
img=imresize(img,[20 20]);
x(113,:)=img(:);
img=imread('DSC_0510.jpg');
img=imresize(img,[20 20]);
x(114,:)=img(:);
img=imread('DSC_0511.jpg');
img=imresize(img,[20 20]);
x(115,:)=img(:);
img=imread('DSC_0512.jpg');
img=imresize(img,[20 20]);
x(116,:)=img(:);
img=imread('DSC_0513.jpg');
img=imresize(img,[20 20]);
x(117,:)=img(:);
img=imread('DSC_0514.jpg');
img=imresize(img,[20 20]);
x(118,:)=img(:);
img=imread('DSC_0515.jpg');
img=imresize(img,[20 20]);
x(119,:)=img(:);
img=imread('DSC_0516.jpg');
img=imresize(img,[20 20]);
x(120,:)=img(:);

y=zeros(120,3);

for i=1:40
    y(i,1)=1;
end
for i=41:80
    y(i,2)=1;
end
for i=81:120
    y(i,3)=1;
end

x=double(x);
x=zscore(x);

numberOfRows=size(x,1);
newRowOrder = randperm(numberOfRows);
x=x(newRowOrder,:);
y=y(newRowOrder,:);

x_train=x(1:100,:);
x_test=x(101:120,:);
y_train=y(1:100,:);
y_test=y(101:120,:);

n=size(x_train,2);
m=size(x_train,1);
num=3;

x1=[ones(m,1) x_train];

%randomly initialising theta
epi=0.5;
Theta1=rand(n,n+1)*(2*epi)-epi;
Theta2=rand(n,n+1)*(2*epi)-epi;
Theta3=rand(num,n+1)*(2*epi)-epi;
Theta=[Theta1(:) ; Theta2(:) ; Theta3(:)];
lambda=0.05;%regularization parameter
alpha=2;%learning rate

%gradient descent
for i=1:2000
    [J(i),grad] = costFunction(m,n,Theta,x1,y_train,lambda,num);
    Theta=Theta-alpha*grad;
    J(i)
end

plot(J(isfinite(J)))
p=predict(20,n,Theta,x_test,num)
[~,b(:,1)]=max(p,[],2);
[~,b(:,2)]=max(y_test,[],2);

accuracy=0;

for i=1:size(b,1)
    if b(i,1)==b(i,2)
        accuracy=accuracy+1;
    end
end

accuracy=accuracy/20;

function [p] = predict(m,n,Theta,test,num)

Theta1=reshape(Theta(1:n*(n+1)),n,n+1);
Theta2=reshape(Theta(1+n*(n+1):2*n*(n+1)),n,n+1);
Theta3=reshape(Theta(1+2*n*(n+1):end),num,n+1);
test=[ones(m,1) test];
p=sig([ones(m,1) sig([ones(m,1) sig(test*Theta1')]*Theta2')]*Theta3');

end

function [J,grad] = costFunction(m,n,Theta,x1,Y,lambda,num) 

Theta1=reshape(Theta(1:n*(n+1)),n,n+1);
Theta2=reshape(Theta(1+n*(n+1):2*n*(n+1)),n,n+1);
Theta3=reshape(Theta(1+2*n*(n+1):end),num,n+1);

h=sig([ones(m,1) sig([ones(m,1) sig(x1*Theta1')]*Theta2')]*Theta3');

J=((-1/m)*sum(sum((Y.*log(h))+((1-Y).*log(1-h)))))+(lambda/(2*m))*(sum(sum(Theta1(:,2:n+1).^2))+sum(sum(Theta2(:,2:n+1).^2))+sum(sum(Theta3(:,2:n+1).^2)));

delta4=h-Y;
delta3=(delta4*Theta3).*[ones(m,1) sig([ones(m,1) sig(x1*Theta1')]*Theta2')].*(1-[ones(m,1) sig([ones(m,1) sig(x1*Theta1')]*Theta2')]);
delta3=delta3(:,2:n+1);
delta2=(delta3*Theta2).*[ones(m,1) sig(x1*Theta1')].*(1-[ones(m,1) sig(x1*Theta1')]);
delta2=delta2(:,2:n+1);
theta1=Theta1;
theta2=Theta2;
theta3=Theta3;
theta1(:,1)=0;
theta2(:,1)=0;
theta3(:,1)=0;
Theta1_grad=(1/m)*(delta2'*x1+lambda*theta1);
Theta2_grad=(1/m)*(delta3'*[ones(m,1) sig(x1*Theta1')]+lambda*theta2);
Theta3_grad=(1/m)*(delta4'*[ones(m,1) sig([ones(m,1) sig(x1*Theta1')]*Theta2')]+lambda*theta3);
grad=[Theta1_grad(:) ; Theta2_grad(:) ; Theta3_grad(:)];
end

function g = sig(z)
g = 1.0 ./ (1.0 + exp(-z));
end
